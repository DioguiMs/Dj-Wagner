Sub FileBackUp()     Dim FileNameWithoutExtension As String     Dim FileExtensionPosition As Integer     Dim BackupFileName As String     Dim localPath As String     Dim oneDriveUrl As String         On Error GoTo ErrorHandler ' Set up error handling     ' Find the position of the last dot in the workbook name to separate the extension     FileExtensionPosition = InStrRev(ActiveWorkbook.Name, ".")         ' Check if there is an extension     If FileExtensionPosition > 0 Then         FileNameWithoutExtension = Left(ActiveWorkbook.Name, FileExtensionPosition - 1)     Else         FileNameWithoutExtension = ActiveWorkbook.Name     End If     ' Create the backup file name     BackupFileName = ActiveWorkbook.Path & "\" & _                      FileNameWithoutExtension & " " & Format(Now, "yyyy-mm-dd_hh-mm-ss") & ".xlsx"         ' Save a copy of the active workbook with a timestamp     ActiveWorkbook.SaveCopyAs Filename:=BackupFileName     MsgBox "Backup saved as: " & BackupFileName ' Confirmation message     Exit Sub ' Exit to avoid running the error handler ErrorHandler:     ' If an error occurs, attempt to convert the OneDrive URL to a local path     oneDriveUrl = ActiveWorkbook.Path & "\" & FileNameWithoutExtension & ".xlsx" ' Example URL     localPath = ConvertOneDriveUrlToLocalPath(oneDriveUrl)         ' Display the local path or an error message     If Dir(localPath) <> "" Then         localPath = Replace(localPath, FileNameWithoutExtension & ".xlsx", "")         BackupFileName = localPath & _                      FileNameWithoutExtension & " " & Format(Now, "yyyy-mm-dd_hh-mm-ss") & ".xlsx"                              ActiveWorkbook.SaveCopyAs Filename:=BackupFileName         MsgBox "Backup saved as: " & BackupFileName     Else         MsgBox "Error saving backup: " & Err.Description & vbCrLf & "And the local path could not be found."     End If End Sub Function ConvertOneDriveUrlToLocalPath(oneDriveUrl As String) As String     Dim localPath As String     Dim userName As String     Dim organizationName As String     Dim basePath As String     Dim filePath As String         ' Set your organization name     organizationName = "Imagine Wireless Inc" ' Replace with your organization name     ' Get the current user's username     userName = Environ("USERNAME")     ' Base path for OneDrive     basePath = "C:\Users\" & userName & "\OneDrive - " & organizationName & "\"     ' Replace the SharePoint URL prefix with the local path     filePath = Replace(oneDriveUrl, "https://imaginewl-my.sharepoint.com/personal/dsilva_imaginewireless_net/Documents/", "")         ' Replace encoded spaces (%20) with actual spaces     filePath = Replace(filePath, "%20", " ")     filePath = Replace(filePath, "/", "\")         ' Combine base path with the file path     localPath = basePath & filePath         ' Return the local path     ConvertOneDriveUrlToLocalPath = localPath End Function  